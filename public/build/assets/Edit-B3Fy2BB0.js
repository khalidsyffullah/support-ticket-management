import{r as g,c as a,o,f as d,t as n,e as f,h as _,b as r,a as c,A as L,n as B,H as I,d as C,F as w,j as x,Z as H,i as R,g as k,a2 as v,w as A,k as y}from"./app-Da9o1nG9.js";import{I as F,h as D}from"./moment-DvHM8Kim.js";import{L as z}from"./Layout-D3xDqLL2.js";import{T as O}from"./TextInput-j_kCMMip.js";import{_ as j,F as Q}from"./FlashMessages-Bq20x2VX.js";import{v as M}from"./v4-SoommWqA.js";import{S as K}from"./SelectInput-04YAfwph.js";import{T as P}from"./TextareaInput-q_x7mjua.js";import{L as G}from"./LoadingButton-DTyW3iP2.js";import{S as W}from"./SelectInputFilter-Cfm5VMgj.js";import{Q as Z}from"./vue-quill.snow-BinEIJQy.js";const J={components:{Icon:F},inheritAttrs:!1,props:{id:{type:String,default(){return`text-input-${M()}`}},type:{type:String,default:"text"},error:String,label:String,editable:{type:[Number,Boolean],default:!1},value:{type:String,default:""},is_required:{type:Boolean,default:!1},placeholder:String,modelValue:String},emits:["update:modelValue"],data(){return{editItem:!1,itemValue:this.value}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()},setSelectionRange(i,e){this.$refs.input.setSelectionRange(i,e)}}},X=["for"],Y={key:1,class:"font-light text-sm flex gap-3"},$={key:2,class:"w-25 flex items-center"},ee=["id","type","placeholder","value"],te={key:3,class:"form-error"};function se(i,e,t,q,s,u){const b=g("icon");return o(),a("div",{class:B(i.$attrs.class)},[t.label?(o(),a("label",{key:0,class:"form-label",for:t.id},n(t.label)+" "+n(t.is_required?"*":""),9,X)):d("",!0),s.itemValue&&!s.editItem?(o(),a("div",Y,[f(n(t.modelValue)+" ",1),t.editable?(o(),_(b,{key:0,name:"edit",onClick:e[0]||(e[0]=m=>s.editItem=!s.editItem),class:"w-4 h-4 mr-1 cursor-pointer"})):d("",!0)])):d("",!0),s.editItem?(o(),a("div",$,[r("input",L({id:t.id,ref:"input"},{...i.$attrs,class:null},{class:["form-input",{error:t.error}],type:t.type,placeholder:t.placeholder,value:t.modelValue,onInput:e[1]||(e[1]=m=>i.$emit("update:modelValue",m.target.value))}),null,16,ee),c(b,{onClick:e[2]||(e[2]=m=>s.editItem=!1),name:"close",class:"w-4 h-4 ml-2 cursor-pointer"})])):d("",!0),t.error?(o(),a("div",te,n(t.error),1)):d("",!0)],2)}const ie=j(J,[["render",se]]),le={components:{Icon:F},inheritAttrs:!1,props:{placeholder:{type:String,default:""},onInput:{type:Function},items:{type:Array},id:{type:String,default(){return`select-input-filter-${M()}`}},editable:[Number,Boolean],error:String,label:String,value:String,modelValue:[String,Number,Boolean]},emits:["update:modelValue","update:value","change"],data(){return{selectedValue:"",selected:this.modelValue,isListVisible:!1,editItem:!1,itemValue:this.value}},watch:{selected(i){this.$emit("update:modelValue",i),this.editItem=!1}},created(){},mounted(){document.addEventListener("click",this.close)},methods:{close(i){this.$el.contains(i.target)||(this.isListVisible=!1)},onFocus(){this.isListVisible=!0},selectItem(i,e){this.$refs.input.value=i.name,this.selected=i.id,this.selectedValue=i.name,this.isListVisible=!1,this.editItem=!1,this.itemValue=i.name,this.$emit("update:modelValue",i.id),this.$emit("update:value",i.name),this.$emit("change",e)},focus(){this.$refs.input.focus()},select(){this.$refs.input.select()}}},re={class:"font-bold text-sm mb-1"},oe={key:0,class:"font-light text-sm flex gap-3"},ne={class:"w-25 flex items-center"},ae=["id","placeholder"],de={key:1,class:"form-error"},ue={key:2,class:"i__filter__list"},me=["onClick"];function ce(i,e,t,q,s,u){const b=g("icon");return o(),a("div",{class:B(["sel__filter",i.$attrs.class]),ref:"sel__filter"},[r("div",re,n(i.$t(t.label)),1),s.itemValue&&!s.editItem?(o(),a("div",oe,[f(n(s.itemValue)+" ",1),t.editable?(o(),_(b,{key:0,name:"edit",onClick:e[0]||(e[0]=m=>s.editItem=!s.editItem),class:"w-4 h-4 mr-1 cursor-pointer"})):d("",!0)])):d("",!0),r("div",ne,[s.editItem?(o(),a("input",L({key:0,id:t.id,ref:"input",class:["form-select w-25",{error:t.error}],type:"text"},{...i.$attrs,class:null},{placeholder:t.placeholder,onInput:e[1]||(e[1]=(...m)=>t.onInput&&t.onInput(...m)),onFocus:e[2]||(e[2]=(...m)=>u.onFocus&&u.onFocus(...m)),onKeydown:[e[3]||(e[3]=I(C((...m)=>i.onArrowDown&&i.onArrowDown(...m),["prevent"]),["down"])),e[4]||(e[4]=I(C((...m)=>i.onArrowUp&&i.onArrowUp(...m),["prevent"]),["up"])),e[5]||(e[5]=I(C((...m)=>i.selectCurrentSelection&&i.selectCurrentSelection(...m),["prevent"]),["enter","tab"]))],autocomplete:"off"}),null,16,ae)):d("",!0),s.editItem?(o(),_(b,{key:1,onClick:e[6]||(e[6]=m=>s.editItem=!1),name:"close",class:"w-4 h-4 ml-2 cursor-pointer"})):d("",!0)]),t.error?(o(),a("div",de,n(t.error),1)):d("",!0),s.isListVisible&&t.items.length?(o(),a("div",ue,[r("ul",null,[(o(!0),a(w,null,x(t.items,(m,h)=>(o(),a("li",{key:h,onClick:E=>u.selectItem(m,i.e)},n(m.name),9,me))),128))])])):d("",!0)],2)}const fe=j(le,[["render",ce]]),he={components:{LoadingButton:G,SelectInput:K,TextInput:O,TextEditInput:ie,TextareaInput:P,Link:R,Head:H,Icon:F,SelectInputFilter:W,SelectEditInput:fe,QuillEditor:Z,FlashMessages:Q},layout:z,props:{title:String,ticket:Object,priorities:Array,statuses:Array,types:Array,departments:Array,all_categories:{required:!1},customers:Array,usersExceptCustomers:Array,attachments:Array,comments:Array,auth:Object,entries:Object,hidden_fields:Object,forwarding_request:Object},remember:!1,data(){return{user:this.$page.props.auth.user,is_team_head:!1,type_status:[],categories:this.all_categories.filter(i=>i.department_id===this.ticket.department_id),sub_categories:this.all_categories.filter(i=>i.parent_id===this.ticket.category_id),comment:"",editCustomer:!1,enableEditor:!1,user_access:this.$page.props.auth.user.access,department_users:this.usersExceptCustomers,form:this.$inertia.form({user_id:this.ticket.user_id,priority_id:this.ticket.priority_id,status_id:this.ticket.status_id,department_id:this.ticket.department_id,category_id:this.ticket.category_id??null,sub_category_id:this.ticket.sub_category_id,assigned_to:this.ticket.assigned_to,type_id:this.ticket.type_id,subject:this.ticket.subject,details:this.ticket.details,files:this.ticket.files,comments:this.ticket.comments,created_at:this.ticket.created_at,removedFiles:[],rating:0,review:""})}},created(){this.auth.user.role.slug==="customer"&&this.statuses.length?this.type_status=this.statuses.filter(i=>i.id===this.form.status_id||i.name.match(/Close.*/)):this.type_status=this.statuses,this.moment=D,this.isTeamHead()},methods:{isTeamHead(){this.ticket.department_id&&this.auth.user.role.slug!=="admin"&&y.get(this.route("department.team_head",{department:this.ticket.department_id,user:this.user.id})).then(i=>{this.is_team_head=i.data})},getCategories(){this.ticket.category="N/A",this.form.category_id=null,this.categories=this.all_categories.filter(i=>i.department_id===this.form.department_id),y.get(this.route("departmental_teams.members",{department:this.form.department_id})).then(i=>{this.department_users=i.data})},getSubCategories(){this.sub_categories=this.all_categories.filter(i=>i.parent_id===this.form.category_id),this.ticket.sub_category="N/A",this.form.sub_category_id=null},doFilter(i){y.get(this.route("filter.customers",{search:i.target.value})).then(e=>{this.customers.splice(0,this.customers.length,...e.data)})},doFilterUsersExceptCustomer(i){if(i.target.value===""||i.target.value===null){this.department_users=this.usersExceptCustomers;return}y.get(this.route("filter.users_except_customer",{search:i.target.value})).then(e=>{this.department_users=e.data})},fileInputChange(i){let e=i.target.files;for(let t=0;t<e.length;t++)this.form.files.push(e[t])},fileRemove(i,e){this.form.files.splice(e,1)},fileBrowse(){this.$refs.file.click()},downloadAttachment(i){const e=document.createElement("a");e.href=window.location.origin+"/files/"+i.path,e.download=i.name,e.click()},removeAttachment(i,e){this.attachments.splice(e,1),this.form.removedFiles.push(i.id)},getFileSize(i){const e=Math.floor(Math.log(i)/Math.log(1024));return(i/Math.pow(1024,e)).toFixed(2)*1+" "+["B","KB","MB","GB","TB"][e]},uploadFiles(){this.form.files=this.$refs.files.files},update(){this.form.post(this.route("tickets.update",this.ticket.id),{onSuccess:()=>{}}),this.form.files=[],this.form.comment=""},destroy(){confirm("Are you sure you want to delete this ticket?")&&this.$inertia.delete(this.route("tickets.destroy",this.ticket.id))},restore(){confirm("Are you sure you want to restore this ticket?")&&this.$inertia.put(this.route("tickets.restore",this.ticket.id))},submitComment(){var i=this;const e={comment:this.comment,user_id:this.user.id,_token:this.$page.props.csrf_token,ticket_id:this.ticket.id};this.comment="",y.post(this.route("ticket.comment"),e).then(t=>{t.data&&i.comments.push(t.data),this.$emit("comment submitted!")}).catch(t=>{console.log(t)})},handleForwardingRequest(i){this.form.processing=!0,y.post(this.route("tickets.forwarding.handle",this.forwarding_request.id),{status:i}).then(e=>{this.form.processing=!1,this.$inertia.reload()}).catch(e=>{this.form.processing=!1,console.error("Error processing the forwarding request. Please try again.")})}}},ge={class:"flex flex-wrap"},_e={class:"max-w-full lg:w-3/5"},be={class:"p-8 -mr-6 -mb-8 flex flex-wrap"},pe={key:4,class:"pr-6 pb-8 w-full lg:w-1/3 text-red-600"},ye={key:5,class:"pr-6 pb-8 w-full text-red-600"},ke={class:"assigned_user pr-6 pb-8 w-full lg:w-1/3 flex flex-col"},ve={class:"font-bold text-sm mb-1"},we={class:"font-light text-sm"},xe={class:"font-bold text-sm mb-1"},Ve={class:"font-light text-sm"},Ce={class:"assigned_user pr-6 pb-8 w-full lg:w-full flex flex-col"},Se={class:"w-25 flex gap-3"},Ie={class:"form-label"},Ae=["innerHTML"],Fe={key:1,class:"w-25 flex items-center ticket_details_area"},je={class:"w-4 h-4 cursor-pointer"},qe={class:"pr-6 pb-8 w-full lg:w-full flex-col"},Ee={class:"flex-1 pr-1"},Ue={class:"text-gray-500 text-xs"},Te=["href"],Le={class:"text-sm"},Be={class:"a__buttons flex justify-end items-center"},Me=["onClick"],Ne=["onClick"],He={class:"flex-1 pr-1"},Re={class:"text-gray-500 text-xs"},De=["onClick"],ze={key:8,class:"pr-6 pb-8 w-full lg:w-1/3 flex items-center"},Oe={key:9,class:"flex flex-col w-full"},Qe={class:"assigned_user star__review pb-5 w-full lg:w-1/3 flex flex-col"},Ke={class:"font-bold"},Pe={class:"star-rating pt-5"},Ge={class:"flex lg:w-1/4 mb-4"},We={class:"btn-indigo",type:"submit"},Ze={key:0,class:"px-8 py-4 bg-yellow-100 border-t border-gray-100 flex items-center"},Je={class:"mr-4"},Xe={class:"px-8 py-4 bg-gray-50 border-t border-gray-100 flex items-center"},Ye={class:"max-w-full lg:w-2/5"},$e={class:"bg-white rounded-md shadow overflow-hidden ml-2 chat-area comment-box flex-1 flex flex-col"},et={class:"flex-3"},tt={class:"chat-header flex flex-col pb-3"},st={class:"text-xl"},it={class:"text-sm font-light"},lt={class:"messages flex-1 overflow-auto reverse__order"},rt={key:0,class:"flex-2"},ot={class:"w-12 h-12 relative"},nt={key:0,class:"w-12 h-12 rounded-full mx-auto user_icon",alt:"chat-user"},at={key:1,class:"flex-1 px-2 mt__wrap"},dt={key:0,class:"font-bold pb-2 text-sm pt-1"},ut=["innerHTML"],mt={class:"pl-4"},ct={class:"text-gray-500"},ft={key:2,class:"flex-1 mt__wrap px-2 text-right"},ht=["innerHTML"],gt={class:"pr-4"},_t={class:"text-gray-500"},bt={class:"flex-2 pt-4 pb-3"},pt={class:"write bg-white shadow flex rounded-lg"},yt={class:"flex-1 ticket_comment_edit"},kt={class:"flex-2 w-35 p-2 flex content-center items-center"},vt={class:"flex-1"};function wt(i,e,t,q,s,u){const b=g("Head"),m=g("flash-messages"),h=g("select-edit-input"),E=g("text-edit-input"),V=g("icon"),U=g("QuillEditor"),N=g("textarea-input"),S=g("loading-button");return o(),a("div",null,[c(b,{title:i.$t(t.title)},null,8,["title"]),r("div",ge,[r("div",_e,[r("form",{onSubmit:e[25]||(e[25]=C((...l)=>u.update&&u.update(...l),["prevent"])),class:"bg-white rounded-md shadow overflow-hidden mr-2"},[c(m),r("div",be,[t.auth.user.role.slug!=="customer"?(o(),_(h,{key:0,placeholder:"Search customer",onInput:u.doFilter,items:t.customers,modelValue:s.form.user_id,"onUpdate:modelValue":e[0]||(e[0]=l=>s.form.user_id=l),error:s.form.errors.user_id,class:"pr-6 pb-8 w-full lg:w-1/3",label:i.$t("Customer"),value:t.ticket.user,editable:s.user_access.ticket.update&&!t.ticket.closed},null,8,["onInput","items","modelValue","error","label","value","editable"])):d("",!0),c(h,{placeholder:"Search priority",items:t.priorities,modelValue:s.form.priority_id,"onUpdate:modelValue":e[1]||(e[1]=l=>s.form.priority_id=l),error:s.form.errors.priority_id,class:"pr-6 pb-8 w-full lg:w-1/3",label:i.$t("Priority"),value:t.ticket.priority,editable:s.user_access.ticket.update&&!t.ticket.closed},null,8,["items","modelValue","error","label","value","editable"]),t.auth.user.role.slug!=="customer"&&!(t.hidden_fields&&t.hidden_fields.includes("assigned_to"))?(o(),_(h,{key:1,placeholder:"Search user",onInput:u.doFilterUsersExceptCustomer,items:s.department_users,modelValue:s.form.assigned_to,"onUpdate:modelValue":e[2]||(e[2]=l=>s.form.assigned_to=l),error:s.form.errors.assigned_to,class:"pr-6 pb-8 w-full lg:w-1/3",label:i.$t("Assigned to"),value:t.ticket.assigned_user??"Not Assigned",editable:s.user_access.ticket.update&&!t.ticket.closed&&t.auth.user.role.slug==="admin"||s.is_team_head},null,8,["onInput","items","modelValue","error","label","value","editable"])):d("",!0),c(h,{placeholder:"Select status to change",items:t.statuses,modelValue:s.form.status_id,"onUpdate:modelValue":e[3]||(e[3]=l=>s.form.status_id=l),error:s.form.errors.status_id,class:"pr-6 pb-8 w-full lg:w-1/3",label:i.$t("Status"),value:t.ticket.status?t.ticket.status.name:"N/A",editable:t.auth.user.role.slug!=="customer"&&s.user_access.ticket.update&&!t.ticket.closed},null,8,["items","modelValue","error","label","value","editable"]),t.hidden_fields&&t.hidden_fields.includes("ticket_type")?d("",!0):(o(),_(h,{key:2,placeholder:"Search type",items:t.types,modelValue:s.form.type_id,"onUpdate:modelValue":e[4]||(e[4]=l=>s.form.type_id=l),error:s.form.errors.type_id,class:"pr-6 pb-8 w-full lg:w-1/3",label:i.$t("Ticket type"),value:t.ticket.type,editable:s.user_access.ticket.update&&!t.ticket.closed},null,8,["items","modelValue","error","label","value","editable"])),t.hidden_fields&&t.hidden_fields.includes("department")?d("",!0):(o(),_(h,{key:3,onChange:e[5]||(e[5]=l=>u.getCategories()),placeholder:"Search department",items:t.departments,modelValue:s.form.department_id,"onUpdate:modelValue":e[6]||(e[6]=l=>s.form.department_id=l),error:s.form.errors.department_id,class:"pr-6 pb-8 w-full lg:w-1/3",label:i.$t("Department"),value:t.ticket.department,editable:s.user_access.ticket.update&&!t.ticket.closed&&t.auth.user.role.slug==="admin"||s.is_team_head&&(!t.forwarding_request||t.forwarding_request.status==="approved")},null,8,["items","modelValue","error","label","value","editable"])),t.forwarding_request&&t.forwarding_request.status==="rejected"?(o(),a("div",pe," A forwarding request for this ticket has been rejected. ")):d("",!0),s.is_team_head&&t.forwarding_request&&t.forwarding_request.status==="pending"?(o(),a("div",ye," A forward request was sent to the admin from your department. Waiting for admin review. ")):d("",!0),!(t.hidden_fields&&t.hidden_fields.includes("category"))&&s.form.department_id?(o(),_(h,{key:6,ref:"category",onChange:e[7]||(e[7]=l=>u.getSubCategories()),placeholder:"Search category",items:s.categories,modelValue:s.form.category_id,"onUpdate:modelValue":e[8]||(e[8]=l=>s.form.category_id=l),error:s.form.errors.category_id,class:"pr-6 pb-8 w-full lg:w-1/3",label:i.$t("Category"),value:t.ticket.category,editable:s.user_access.ticket.update&&!t.ticket.closed},null,8,["items","modelValue","error","label","value","editable"])):d("",!0),!(t.hidden_fields&&t.hidden_fields.includes("category"))&&s.form.category_id?(o(),_(h,{key:7,ref:"sub_category",placeholder:"Search category",items:s.sub_categories,modelValue:s.form.sub_category_id,"onUpdate:modelValue":e[9]||(e[9]=l=>s.form.sub_category_id=l),error:s.form.errors.sub_category_id,class:"pr-6 pb-8 w-full lg:w-1/3",label:i.$t("Sub Category"),value:t.ticket.sub_category,editable:s.user_access.ticket.update&&!t.ticket.closed},null,8,["items","modelValue","error","label","value","editable"])):d("",!0),r("div",ke,[r("div",ve,n(i.$t("Created")),1),r("div",we,n(i.moment(t.ticket.created_at).fromNow()),1)]),(o(!0),a(w,null,x(t.entries,l=>(o(),a("div",{class:"assigned_user pr-6 pb-8 w-full lg:w-1/3 flex flex-col",key:l.id},[r("div",xe,n(i.$t(l.label)),1),r("div",Ve,n(l.value),1)]))),128)),c(E,{editable:s.user_access.ticket.update&&!t.ticket.closed,modelValue:s.form.subject,"onUpdate:modelValue":e[10]||(e[10]=l=>s.form.subject=l),value:t.ticket.subject,error:s.form.errors.subject,class:"pr-6 pb-8 w-full lg:w-2/3",label:i.$t("Subject")},null,8,["editable","modelValue","value","error","label"]),r("div",Ce,[r("div",Se,[r("label",Ie,n(i.$t("Request Details")),1),!s.enableEditor&&s.user_access.ticket.update&&!t.ticket.closed?(o(),_(V,{key:0,name:"edit",onClick:e[11]||(e[11]=l=>s.enableEditor=!s.enableEditor),class:"w-4 h-4 mr-1 cursor-pointer"})):d("",!0)]),s.enableEditor?d("",!0):(o(),a("div",{key:0,class:"font-light text-sm",innerHTML:t.ticket.details},null,8,Ae)),s.enableEditor?(o(),a("div",Fe,[c(U,{theme:"snow",toolbar:"full",content:s.form.details,"onUpdate:content":e[12]||(e[12]=l=>s.form.details=l),contentType:"html"},null,8,["content"]),r("div",je,[c(V,{onClick:e[13]||(e[13]=l=>s.enableEditor=!1),name:"close",class:"w-4 h-4 ml-2 cursor-pointer"})])])):d("",!0)]),r("input",{ref:"file",type:"file",accept:".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.txt,.pdf, .zip",class:"hidden",multiple:"multiple",onChange:e[14]||(e[14]=(...l)=>u.fileInputChange&&u.fileInputChange(...l))},null,544),r("div",qe,[r("button",{type:"button",class:"btn flex justify-center items-center pb-3 border-0 pl-0",onClick:e[15]||(e[15]=(...l)=>u.fileBrowse&&u.fileBrowse(...l))},[c(V,{name:"file",class:"flex-shrink-0 h-5 fill-gray-400 pr-1"}),e[28]||(e[28]=f()),r("strong",null,n(i.$t("Attach File")),1)]),t.attachments.length?(o(!0),a(w,{key:0},x(t.attachments,(l,p)=>(o(),a("div",{class:"flex items-center justify-between pr-6 pt-8 w-full",key:p},[r("div",Ee,[f(n(l.name)+" ",1),r("span",Ue,"("+n(u.getFileSize(l.size))+")",1),e[29]||(e[29]=f()),l.user?(o(),a("a",{key:0,class:"text-sm",href:this.route("users.edit",l.user.id)},n(l.user.first_name)+" "+n(l.user.last_name),9,Te)):d("",!0),e[30]||(e[30]=f(" at ")),r("span",Le,n(l.created_at),1)]),r("div",Be,[r("button",{type:"button",class:"btn flex items-center",onClick:T=>u.downloadAttachment(l)},n(i.$t("Download")),9,Me),r("button",{type:"button",class:"btn flex items-center ml-3",onClick:T=>u.removeAttachment(l,p)},n(i.$t("Remove")),9,Ne)])]))),128)):d("",!0),s.form.files.length?(o(!0),a(w,{key:1},x(s.form.files,(l,p)=>(o(),a("div",{class:"flex items-center justify-between pr-6 pt-8 w-full lg:w-1/2",key:p},[r("div",He,[f(n(l.name)+" ",1),r("span",Re,"("+n(u.getFileSize(l.size))+")",1)]),s.user_access.ticket.delete&&t.ticket.status&&!t.ticket.closed?(o(),a("button",{key:0,type:"button",class:"btn flex justify-center items-center",onClick:T=>u.fileRemove(l,p)},n(i.$t("Remove")),9,De)):d("",!0)]))),128)):d("",!0)]),t.ticket.status&&t.ticket.closed&&t.ticket.review?(o(),a("div",ze,[r("strong",null,n(i.$t("Rating"))+": ",1),f("   "+n(t.ticket.review.rating)+" ",1),r("p",null,n(t.ticket.review.review),1)])):d("",!0),t.ticket.status&&t.ticket.closed&&!t.ticket.review&&t.auth.user.role.slug==="customer"?(o(),a("div",Oe,[r("div",Qe,[r("div",Ke,n(i.$t("How do you rate this support service?")),1),r("div",Pe,[k(r("input",{type:"radio",id:"5-stars",name:"rating","onUpdate:modelValue":e[16]||(e[16]=l=>s.form.rating=l),value:"5"},null,512),[[v,s.form.rating]]),e[31]||(e[31]=r("label",{for:"5-stars",class:"star"},"★",-1)),k(r("input",{type:"radio",id:"4-stars",name:"rating","onUpdate:modelValue":e[17]||(e[17]=l=>s.form.rating=l),value:"4"},null,512),[[v,s.form.rating]]),e[32]||(e[32]=r("label",{for:"4-stars",class:"star"},"★",-1)),k(r("input",{type:"radio",id:"3-stars",name:"rating","onUpdate:modelValue":e[18]||(e[18]=l=>s.form.rating=l),value:"3"},null,512),[[v,s.form.rating]]),e[33]||(e[33]=r("label",{for:"3-stars",class:"star"},"★",-1)),k(r("input",{type:"radio",id:"2-stars",name:"rating","onUpdate:modelValue":e[19]||(e[19]=l=>s.form.rating=l),value:"2"},null,512),[[v,s.form.rating]]),e[34]||(e[34]=r("label",{for:"2-stars",class:"star"},"★",-1)),k(r("input",{type:"radio",id:"1-star",name:"rating","onUpdate:modelValue":e[20]||(e[20]=l=>s.form.rating=l),value:"1"},null,512),[[v,s.form.rating]]),e[35]||(e[35]=r("label",{for:"1-star",class:"star"},"★",-1))])]),c(N,{modelValue:s.form.review,"onUpdate:modelValue":e[21]||(e[21]=l=>s.form.review=l),error:s.form.errors.review,class:"pr-6 pb-4 w-full lg:w-1/3",label:i.$t("Feedback")},null,8,["modelValue","error","label"]),r("div",Ge,[r("button",We,n(i.$t("Submit")),1)])])):d("",!0)]),t.auth.user.role.slug==="admin"&&t.forwarding_request&&t.forwarding_request.status==="pending"?(o(),a("div",Ze,[r("div",Je,"This ticket has a pending forwarding request from "+n(t.forwarding_request.old_department.name)+" to "+n(t.forwarding_request.new_department.name)+".",1),c(S,{loading:s.form.processing,onClick:e[22]||(e[22]=l=>u.handleForwardingRequest("approved")),class:"btn-indigo mr-2"},{default:A(()=>e[36]||(e[36]=[f("Accept")])),_:1,__:[36]},8,["loading"]),c(S,{loading:s.form.processing,onClick:e[23]||(e[23]=l=>u.handleForwardingRequest("rejected")),class:"btn-red"},{default:A(()=>e[37]||(e[37]=[f("Reject")])),_:1,__:[37]},8,["loading"])])):d("",!0),r("div",Xe,[s.user_access.ticket.delete?(o(),a("button",{key:0,class:"text-red-600 hover:underline",tabindex:"-1",type:"button",onClick:e[24]||(e[24]=(...l)=>u.destroy&&u.destroy(...l))},n(i.$t("Delete")),1)):d("",!0),c(S,{loading:s.form.processing,class:"btn-indigo ml-auto",type:"submit"},{default:A(()=>[f(n(i.$t("Save")),1)]),_:1},8,["loading"])])],32)]),r("div",Ye,[r("div",$e,[r("div",et,[r("div",tt,[r("h3",st,n(i.$t("Ticket discussion")),1),r("p",it,n(i.$t("Comment histories for this ticket will be available here.")),1)])]),r("div",lt,[(o(!0),a(w,null,x(t.comments.slice().reverse(),(l,p)=>(o(),a("div",{key:p,class:"message mb-4 flex"},[l.user_id!==s.user.id?(o(),a("div",rt,[r("div",ot,[l.user?(o(),a("span",nt,n(Array.from(l.user.first_name)[0]),1)):d("",!0)])])):d("",!0),l.user_id!==s.user.id?(o(),a("div",at,[l.user?(o(),a("h3",dt,n(l.user.first_name)+" "+n(l.user.last_name),1)):d("",!0),r("div",{class:"inline-block bg-gray-300 user-comment-round p-2 px-3 text-gray-700 leading-5 ckc",innerHTML:l.details},null,8,ut),r("div",mt,[r("small",ct,n(i.moment(l.updated_at).fromNow(!0)),1)])])):d("",!0),l.user_id===s.user.id?(o(),a("div",ft,[r("div",{class:"inline-block bg-blue rounded p-2 px-3 text-white leading-5 ckc",innerHTML:l.details},null,8,ht),r("div",gt,[r("small",_t,n(i.moment(l.updated_at).fromNow(!0)),1)])])):d("",!0)]))),128))]),r("div",bt,[r("div",pt,[r("div",yt,[c(U,{theme:"snow",toolbar:"full",content:s.comment,"onUpdate:content":e[26]||(e[26]=l=>s.comment=l),contentType:"html"},null,8,["content"])]),r("div",kt,[r("div",vt,[r("button",{class:"bg-blue w-10 h-10 rounded-full flex justify-center items-center",onClick:e[27]||(e[27]=(...l)=>u.submitComment&&u.submitComment(...l))},[c(V,{class:"w-4 h-4 fill-gray-100",name:"send"})])])])])])])])])])}const Tt=j(he,[["render",wt]]);export{Tt as default};
