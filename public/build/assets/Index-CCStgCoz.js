import{m as S,p as j,q as B,h as L,o as a,a as h,w as f,g,b as e,T as k,s as y,n as p,u as T,f as m,x as H,Z as z,r as M,c as d,t as r,F as x,j as w,e as b,d as v,y as E,k as C}from"./app-BiPF-rgh.js";import{L as I}from"./Layout-BxXRfBj5.js";import{_ as U}from"./FlashMessages-CKu9mpmF.js";import{L as N}from"./LoadingButton-ChX3xwPs.js";import"./moment-x6zV2OKy.js";const $={emits:["close"],props:{show:{type:Boolean,default:!1},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0}},watch:{show:{immediate:!0,handler:t=>{t?document.body.style.overflow="hidden":document.body.style.overflow=null}}},setup(t,{emit:s}){const l=()=>{t.closeable&&s("close")},c=i=>{i.key==="Escape"&&t.show&&l()};return S(()=>document.addEventListener("keydown",c)),j(()=>{document.removeEventListener("keydown",c),document.body.style.overflow=null}),{maxWidthClass:B(()=>({sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-lg",xl:"sm:max-w-xl","2xl":"sm:max-w-2xl"})[t.maxWidth]),close:l}}},Q={class:"fixed inset-0 overflow-y-auto px-4 py-6 sm:px-0 z-50","scroll-on-focus":"true"};function V(t,s,l,c,n,i){return a(),L(H,{to:"body"},[h(k,{"leave-active-class":"duration-200"},{default:f(()=>[g(e("div",Q,[h(k,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:f(()=>[g(e("div",{class:"fixed inset-0 transform transition-all",onClick:s[0]||(s[0]=(..._)=>c.close&&c.close(..._))},s[1]||(s[1]=[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75"},null,-1)]),512),[[y,l.show]])]),_:1}),h(k,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to-class":"opacity-100 translate-y-0 sm:scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 translate-y-0 sm:scale-100","leave-to-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:f(()=>[g(e("div",{class:p(["mb-6 bg-white rounded-lg overflow-hidden shadow-xl transform transition-all sm:w-full sm:mx-auto",c.maxWidthClass])},[l.show?T(t.$slots,"default",{key:0}):m("",!0)],2),[[y,l.show]])]),_:3})],512),[[y,l.show]])]),_:3})])}const W=U($,[["render",V]]),O={components:{Head:z,Modal:W,LoadingButton:N},layout:I,props:{departments:Array},data(){return{selectedDepartment:null,teamMembers:[],showAddMemberModal:!1,showDropdown:!1,availableUsers:[],searchQuery:"",selectedUsers:[],form:this.$inertia.form({user_ids:[],team_head:!1})}},computed:{filteredUsers(){if(!this.searchQuery)return this.availableUsers;const t=this.searchQuery.toLowerCase();return this.availableUsers.filter(s=>{const l=`${s.first_name} ${s.last_name}`.toLowerCase(),c=s.email.toLowerCase();return l.includes(t)||c.includes(t)})}},methods:{async viewMembers(t){this.selectedDepartment=t;const s=await C.get(this.route("departmental_teams.members",t.id));this.teamMembers=s.data},toggleDropdown(){this.showDropdown=!this.showDropdown,this.showDropdown&&this.$nextTick(()=>{this.$refs.searchInput&&this.$refs.searchInput.focus()})},toggleUserSelection(t){const s=this.selectedUsers.findIndex(l=>l.id===t.id);s>-1?this.selectedUsers.splice(s,1):this.selectedUsers.push(t),this.form.user_ids=this.selectedUsers.map(l=>l.id)},removeSelectedUser(t){const s=this.selectedUsers.findIndex(l=>l.id===t.id);s>-1&&(this.selectedUsers.splice(s,1),this.form.user_ids=this.selectedUsers.map(l=>l.id))},isUserSelected(t){return this.selectedUsers.some(s=>s.id===t.id)},selectUser(t){this.selectedUser=t,this.form.user_id=t.id,this.showDropdown=!1,this.searchQuery=""},closeAddMemberModal(){this.showAddMemberModal=!1,this.showDropdown=!1,this.selectedUsers=[],this.searchQuery="",this.form.reset()},onSearchInput(){this.showDropdown||(this.showDropdown=!0)},handleClickOutside(t){this.$refs.dropdownContainer&&!this.$refs.dropdownContainer.contains(t.target)&&(this.showDropdown=!1)},async addMember(){!this.selectedDepartment||this.selectedUsers.length===0||await this.form.post(this.route("departmental_teams.add_member",this.selectedDepartment.id),{onSuccess:()=>{this.closeAddMemberModal(),this.viewMembers(this.selectedDepartment),this.$page.props.flash.success=`${this.selectedUsers.length} team member(s) added successfully.`},onError:t=>{console.error(t)}})},async removeMember(t){confirm("Are you sure you want to remove this member?")&&await this.$inertia.delete(this.route("departmental_teams.remove_member",{department:this.selectedDepartment.id,user:t.id}),{onSuccess:()=>{this.viewMembers(this.selectedDepartment),this.$page.props.flash.success="Team member removed successfully."},onError:s=>{console.error(s)}})},async fetchAvailableUsers(){try{const t=await C.get(this.route("departmental_teams.users"));this.availableUsers=t.data}catch(t){console.error("Error fetching users:",t)}},async updateTeamHead(t,s){await this.$inertia.put(this.route("departmental_teams.update_head",{department:this.selectedDepartment.id,user:t.id}),{team_head:s},{onSuccess:()=>{this.viewMembers(this.selectedDepartment),this.$page.props.flash.success="Team head updated successfully."},onError:l=>{console.error(l)}})}},created(){this.fetchAvailableUsers()},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}},q={class:"min-h-screen bg-gray-50 py-8"},F={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},G={class:"mb-8"},R={class:"text-4xl font-bold text-gray-900"},Y={class:"mt-2 text-lg text-gray-600"},Z={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8"},J={class:"p-6"},K={class:"flex items-center justify-between mb-4"},P={class:"text-right"},X={class:"text-2xl font-bold text-indigo-600"},ee={class:"text-xs text-gray-500 uppercase tracking-wide"},te={class:"text-xl font-semibold text-gray-900 mb-2 group-hover:text-indigo-600 transition-colors"},se=["onClick"],oe={key:0,class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},re={class:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-8"},ie={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},ne={class:"mb-4 sm:mb-0"},le={class:"text-2xl font-bold text-white"},ae={class:"text-indigo-100 mt-1"},de={class:"overflow-x-auto"},ce={class:"w-full"},me={class:"bg-gray-50 border-b border-gray-200"},he={class:"px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"},ue={class:"px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"},pe={class:"px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"},fe={class:"px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider"},ge={class:"divide-y divide-gray-200"},xe={class:"px-6 py-4 whitespace-nowrap"},we={class:"flex items-center"},be={class:"flex-shrink-0 h-10 w-10"},ve={class:"h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center"},ye={class:"text-white font-medium text-sm"},_e={class:"ml-4"},ke={class:"text-sm font-medium text-gray-900"},Me={class:"px-6 py-4 whitespace-nowrap"},Ce={class:"text-sm text-gray-600"},Ue={class:"px-6 py-4 whitespace-nowrap"},De={class:"flex items-center cursor-pointer"},Ae=["checked","onChange"],Se={class:"ml-2 text-sm text-gray-700"},je={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Be=["onClick"],Le={key:0},Te={colspan:"4",class:"px-6 py-12 text-center"},He={class:"flex flex-col items-center"},ze={class:"text-lg font-medium text-gray-900 mb-1"},Ee={class:"text-gray-500"},Ie={class:"bg-white"},Ne={class:"flex items-center justify-between p-6 border-b border-gray-200"},$e={class:"text-xl font-semibold text-gray-900"},Qe={class:"p-6"},Ve={class:"mb-6"},We={class:"block text-sm font-medium text-gray-700 mb-2"},Oe={class:"relative",ref:"dropdownContainer"},qe={key:0,class:"flex flex-wrap gap-1"},Fe=["onClick"],Ge={key:1,class:"block truncate text-gray-500"},Re={class:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none"},Ye={class:"sticky top-0 bg-white p-2 border-b border-gray-200"},Ze={class:"relative"},Je=["placeholder"],Ke={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},Pe=["onClick"],Xe={class:"flex items-center"},et={class:"flex-shrink-0 mr-3"},tt={key:0,class:"w-3 h-3 text-white ml-0.5 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},st={class:"flex-shrink-0 h-8 w-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mr-3"},ot={class:"text-white text-xs font-medium"},rt={class:"flex-1 min-w-0"},it={class:"text-sm font-medium text-gray-900 truncate"},nt={class:"text-sm text-gray-500 truncate"},lt={key:0,class:"mt-1 text-sm text-red-600"},at={class:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50 rounded-b-xl"};function dt(t,s,l,c,n,i){const _=M("Head"),D=M("loading-button"),A=M("Modal");return a(),d("div",q,[h(_,{title:t.$t("Departmental Teams")},null,8,["title"]),e("div",F,[e("div",G,[e("h1",R,r(t.$t("Departmental Teams")),1),e("p",Y,r(t.$t("Manage your organizational departments and team members")),1)]),e("div",Z,[(a(!0),d(x,null,w(l.departments,o=>(a(),d("div",{key:o.id,class:"group bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 border border-gray-200 hover:border-indigo-300"},[e("div",J,[e("div",K,[s[8]||(s[8]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),e("div",P,[e("div",X,r(o.users_count),1),e("div",ee,r(t.$t("Members")),1)])]),e("h3",te,r(o.name),1),e("button",{onClick:u=>i.viewMembers(o),class:"w-full mt-4 px-4 py-2.5 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transform hover:scale-[1.02] transition-all duration-200 font-medium shadow-md hover:shadow-lg"},r(t.$t("View Members")),9,se)])]))),128))]),n.selectedDepartment?(a(),d("div",oe,[e("div",re,[e("div",ie,[e("div",ne,[e("h2",le,r(n.selectedDepartment.name),1),e("p",ae,r(t.$t("Team Members Management")),1)]),e("button",{onClick:s[0]||(s[0]=o=>n.showAddMemberModal=!0),class:"inline-flex items-center px-6 py-3 bg-white text-indigo-600 rounded-lg hover:bg-gray-50 font-medium shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105"},[s[9]||(s[9]=e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),b(" "+r(t.$t("Add New Team Member")),1)])])]),e("div",de,[e("table",ce,[e("thead",me,[e("tr",null,[e("th",he,r(t.$t("Member")),1),e("th",ue,r(t.$t("Email")),1),e("th",pe,r(t.$t("Team Head")),1),e("th",fe,r(t.$t("Actions")),1)])]),e("tbody",ge,[(a(!0),d(x,null,w(n.teamMembers,o=>(a(),d("tr",{key:o.id,class:"hover:bg-gray-50 transition-colors duration-150"},[e("td",xe,[e("div",we,[e("div",be,[e("div",ve,[e("span",ye,r(o.first_name.charAt(0))+r(o.last_name.charAt(0)),1)])]),e("div",_e,[e("div",ke,r(o.first_name)+" "+r(o.last_name),1)])])]),e("td",Me,[e("div",Ce,r(o.email),1)]),e("td",Ue,[e("label",De,[e("input",{type:"checkbox",checked:o.pivot.team_head,onChange:u=>i.updateTeamHead(o,u.target.checked),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded transition-colors"},null,40,Ae),e("span",Se,r(o.pivot.team_head?t.$t("Yes"):t.$t("No")),1)])]),e("td",je,[e("button",{onClick:u=>i.removeMember(o),class:"inline-flex items-center px-3 py-1.5 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors duration-150"},[s[10]||(s[10]=e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),b(" "+r(t.$t("Remove")),1)],8,Be)])]))),128)),n.teamMembers.length===0?(a(),d("tr",Le,[e("td",Te,[e("div",He,[s[11]||(s[11]=e("svg",{class:"w-12 h-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),e("h3",ze,r(t.$t("No team members")),1),e("p",Ee,r(t.$t("Get started by adding your first team member.")),1)])])])):m("",!0)])])])])):m("",!0)]),h(A,{show:n.showAddMemberModal,onClose:i.closeAddMemberModal},{default:f(()=>[e("div",Ie,[e("div",Ne,[e("h3",$e,r(t.$t("Add Team Member")),1),e("button",{onClick:s[1]||(s[1]=(...o)=>i.closeAddMemberModal&&i.closeAddMemberModal(...o)),class:"text-gray-400 hover:text-gray-600 transition-colors"},s[12]||(s[12]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Qe,[e("div",Ve,[e("label",We,r(t.$t("Select User")),1),e("div",Oe,[e("button",{onClick:s[2]||(s[2]=v((...o)=>i.toggleDropdown&&i.toggleDropdown(...o),["stop"])),type:"button",class:p(["relative w-full bg-white border border-gray-300 rounded-lg shadow-sm pl-3 pr-10 py-3 text-left cursor-pointer focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all min-h-[48px]",{"border-red-300 focus:ring-red-500 focus:border-red-500":n.form.errors.user_ids}])},[n.selectedUsers.length>0?(a(),d("div",qe,[(a(!0),d(x,null,w(n.selectedUsers,o=>(a(),d("span",{key:o.id,class:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-indigo-100 text-indigo-800"},[b(r(o.first_name)+" "+r(o.last_name)+" ",1),e("button",{onClick:v(u=>i.removeSelectedUser(o),["stop"]),class:"ml-1 inline-flex items-center justify-center w-4 h-4 text-indigo-400 hover:text-indigo-600"},s[13]||(s[13]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Fe)]))),128))])):(a(),d("span",Ge,r(t.$t("Select users")),1)),e("span",Re,[(a(),d("svg",{class:p(["h-5 w-5 text-gray-400 transition-transform",{"rotate-180":n.showDropdown}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s[14]||(s[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])],2),g(e("div",{onClick:s[6]||(s[6]=v(()=>{},["stop"])),class:"absolute z-50 mt-1 w-full bg-white shadow-lg max-h-60 rounded-lg py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none"},[e("div",Ye,[e("div",Ze,[g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>n.searchQuery=o),ref:"searchInput",type:"text",placeholder:t.$t("Search by name or email..."),class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",onClick:s[4]||(s[4]=v(()=>{},["stop"])),onInput:s[5]||(s[5]=(...o)=>i.onSearchInput&&i.onSearchInput(...o))},null,40,Je),[[E,n.searchQuery]]),s[15]||(s[15]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),i.filteredUsers.length===0?(a(),d("div",Ke,r(n.searchQuery?t.$t("No users found matching your search"):t.$t("No users available")),1)):m("",!0),(a(!0),d(x,null,w(i.filteredUsers,o=>(a(),d("div",{key:o.id,onClick:u=>i.toggleUserSelection(o),class:p(["w-full text-left px-4 py-3 text-sm hover:bg-indigo-50 focus:bg-indigo-50 focus:outline-none transition-colors cursor-pointer border-l-4",i.isUserSelected(o)?"bg-indigo-50 border-indigo-500":"border-transparent"])},[e("div",Xe,[e("div",et,[e("div",{class:p(["w-4 h-4 border-2 rounded transition-all",i.isUserSelected(o)?"bg-indigo-600 border-indigo-600":"border-gray-300"])},[i.isUserSelected(o)?(a(),d("svg",tt,s[16]||(s[16]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)]))):m("",!0)],2)]),e("div",st,[e("span",ot,r(o.first_name.charAt(0))+r(o.last_name.charAt(0)),1)]),e("div",rt,[e("p",it,r(o.first_name)+" "+r(o.last_name),1),e("p",nt,r(o.email),1)])])],10,Pe))),128))],512),[[y,n.showDropdown]])],512),n.form.errors.user_ids?(a(),d("div",lt,r(n.form.errors.user_ids),1)):m("",!0)])]),e("div",at,[e("button",{onClick:s[7]||(s[7]=(...o)=>i.closeAddMemberModal&&i.closeAddMemberModal(...o)),type:"button",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"},r(t.$t("Cancel")),1),h(D,{loading:n.form.processing,disabled:n.selectedUsers.length===0,onClick:i.addMember,class:"px-6 py-2 text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 transition-all shadow-md"},{default:f(()=>[b(r(n.selectedUsers.length>0?t.$t(`Add ${n.selectedUsers.length} Member(s)`):t.$t("Add Members")),1)]),_:1},8,["loading","disabled","onClick"])])])]),_:1},8,["show","onClose"])])}const ft=U(O,[["render",dt]]);export{ft as default};
